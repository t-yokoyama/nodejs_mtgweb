<!doctype html>
<html>
  <head>
    <title>MTG web</title>

    <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>

    <style>

      body {
        margin: 0px;
        padding: 0px;
        font: 13px Helvetica, Arial;
      }

      div {
        box-sizing: border-box;
      }

      div#window {
        height: 100%;
        width: 100%;
        top: 0px;
        bottom: 0px;
        left: 0px;
        right: 0px;
        position: absolute;
      }

      div#battlefield_wrapper {
        top: 130px;
        bottom: 130px;
        left: 0px;
        right: 0px;
        position: absolute;
      }

      div.battlefield {
        height: 50%;
        width: 100%;
        position: relative;
      }

      div#my_battlefield { background-color: #ffcccc; }
      div#opp_battlefield { background-color: #ccffcc; }

      div.zone {
        background-color: #cccccc;
        height: 130px;
        width: 100px;
        position: absolute;
        padding: 0px;
        border: 1px;
        border-style: dashed;
      }

      div#library { top: 20px; left: 140px; }
      div#graveyard { top: 20px; left: 20px; }
      div#exile { top: 20px; right: 20px; }

      div#hand {
        width: 100%;
        bottom: 0px;
        position: absolute;
      }

      img.card {
        background-color: #aaaaaa;
        height: 130px;
        width: 100px;
        position: absolute;
      }

    </style>



    <script>

      function generateCard(cardId, image) {

        var imgElement = document.createElement("img");
        imgElement.id = cardId;
        imgElement.src = image;
        imgElement.setAttribute("class", "card my_card");
        document.getElementById("my_battlefield").appendChild(imgElement);

        $("#" + cardId).css("top", 20);
        $("#" + cardId).css("left", 140);

        cardEntry = {
          imgSrc : "images/cardback.jpg",
          zone : ZoneEnum.LIBRARY,
          tapped : false,
          faceDown : true,
          flipped : false,
          transformed : false,
          numCounters : 0
        };
        g_directory.push(cardEntry);
        g_library.push(cardId);
      }

      function moveCardToZone() {
      }

      function displayLibrary() {
      }

      function displayGraveyard() {
      }

      function displayExile() {
      }

      function displayHand() {
      }







      $(document).ready(function() {

        // global variables
        window.ZoneEnum = {
          BATTLEFIELD : 1,
          HAND : 2,
          LIBRARY : 3,
          GRAVEYARD : 4,
          EXILE : 5
        };

        window.g_directory = [];
        window.g_library = [];
        window.g_graveyard = [];
        window.g_exile = [];
        window.g_hand = [];



        generateCard(0, "images/forest.jpg");
        generateCard(1, "images/seraph_of_dawn.jpg");

        $(".my_card").draggable({ // grid: [20, 20],
                                  snap: ".zone",
                                  snapMode: "inner",
                                  snapTolerance: 65});


        $("#window").droppable({
          accept: ".my_card",
          drop: function( event, ui ) {

            // why doesn't think work?
            ui.draggable.src = "images/cardback.jpg"
            ui.draggable.height = "200"
          }
        });
        
        $("#hand").droppable({
          accept: ".my_card",
          greedy: true,
          drop: function( event, ui ) {
            // hand drag code

          }
        });

        $("#library").droppable({
          accept: ".my_card",
          greedy: true,
          drop: function( event, ui ) {
            // lib drag code

          }
        });

        $("#graveyard").droppable({
          accept: ".my_card",
          greedy: true,
          drop: function( event, ui ) {
            // graveyard drag code

          }
        });

        $("#exile").droppable({
          accept: ".my_card",
          greedy: true,
          drop: function( event, ui ) {
            // exile drag code

          }
        });




/*
        $("#button1").click(function() {
          $("#card1").show();
          $("#card1").offset({ top: 100, left: 100 });
          $("#card2").show();
          $("#card2").offset({ top: 100, left: 200 });
        });

        $("#button2").click(function() {
          $("#card1").hide();
          $("#card2").hide();
        });
*/

      });
    </script>

  </head>

  <body>

<!--
    <button type="button" id="button1">reset cards</button>
    <button type="button" id="button2">hide cards</button>
-->

    <div id="window">

      <div id="battlefield_wrapper">
        <div class="battlefield" id="opp_battlefield">opp battlefield</div>
        <div class="battlefield" id="my_battlefield">my battlefield
          <div class="zone" id="library">library</div>
          <div class="zone" id="graveyard">graveyard</div>
          <div class="zone" id="exile">exile</div>
        </div>
      </div>
      <div class="zone" id="hand">hand</div>
    </div>

<!--
    <ul id="messages"></ul>
    <form action="">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form>

    <script>
      var client_io = io();
      $('form').submit(function(){
        client_io.emit('chat message', $('#m').val());
        $('#m').val('');
        return false;
      });
      client_io.on('chat message', function(msg){
        $('#messages').append($('<li>').text(msg));
      });
    </script>
-->



  </body>
</html>
