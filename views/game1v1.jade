doctype html
html

  head

    title 1v1 Game

    link(href="stylesheets/jquery.contextmenu.css", rel="stylesheet")
    link(href="stylesheets/gameplay.css", rel="stylesheet")

    script(src="https://cdn.socket.io/socket.io-1.2.0.js")
    script(src='https://code.jquery.com/jquery-1.9.1.min.js')
    script(src="https://code.jquery.com/ui/1.11.4/jquery-ui.js")
    // script(src="javascripts/jquery.contextmenu.js")
    script(src="javascripts/gameplay.js")

    script.

      $(document).ready(function() {

        var client_io = io('/game1v1');
        window.g_client_io = client_io;

        initGlobals();
        setClientIOCallbacks();

        client_io.on('connect', function(data) {

          // extract the room id from the url and join that room
          var params = {};
          if (location.search) {
            var parts = location.search.substring(1).split('&');
            for (var i = 0; i < parts.length; i++) {
              var nv = parts[i].split('=');
              if (!nv[0]) continue;
              params[nv[0]] = nv[1] || true;
            }
          }
          
          // FIXME add error checking for room id is not found
          client_io.emit('join_room', { userid: '#{user.id}',
                                        roomid: params.room });
        });

      });


  body

    div(id="window")
      div(id="battlefield_wrapper")
        div(class="battlefield", id="opp_battlefield") opp_battlefield
          div(class="zone", id="opp_hand") opp_hand
          div(class="opp_zone", id="opp_library") opp_library
          div(class="opp_zone", id="opp_graveyard") opp_graveyard
          div(class="opp_zone", id="opp_exile") opp_exile
        div(class="battlefield", id="my_battlefield") my_battlefield
          div(class="zone", id="library") library
          div(class="zone", id="graveyard") graveyard
          div(class="zone", id="exile") exile
          div(class="zone", id="hand") hand

